var z=Object.defineProperty,H=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var y=(t,a,o)=>a in t?z(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o,B=(t,a)=>{for(var o in a||(a={}))J.call(a,o)&&y(t,o,a[o]);if(E)for(var o of E(a))U.call(a,o)&&y(t,o,a[o]);return t},S=(t,a)=>H(t,P(a));import{e as u,W as w,X as k,Y as D,a4 as X,m as Y,i as G,a5 as K,d as i,j as r,k as F,F as Q}from"./vendor.3adfed64.js";import{O as L,a as _,S as d}from"./OmsMenuItem.851b2a4d.js";import{b as V,u as Z}from"./url.3ef8f631.js";import{b as T}from"./MenuItem.fff0d7f8.js";import{T as ee}from"./TextField.84619a02.js";var g={},te=k.exports,ae=D.exports;Object.defineProperty(g,"__esModule",{value:!0});var I=g.default=void 0,re=ae(u.exports),oe=te(w),se=(0,oe.default)(re.createElement("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"}),"Send");I=g.default=se;var f={},ue=k.exports,ne=D.exports;Object.defineProperty(f,"__esModule",{value:!0});var N=f.default=void 0,le=ne(u.exports),ie=ue(w),de=(0,ie.default)(le.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");N=f.default=de;const ce=(t,a)=>S(B({},a),{hostList:t.hostList,groupList:t.groupList,tagList:t.tagList}),pe={},me=Y(t=>G({root:{width:"98%",height:"100%"},ControlBox:{marginBottom:"20px",width:"100%",display:"flex",alignContent:"space-evenly",alignItems:"center",justifyContent:"space-between"},Control:{width:"20%"},sendButton:{marginTop:"12px",height:"45px",width:"120px",backgroundColor:t.palette.success[t.palette.type],"&:hover":{backgroundColor:t.palette.success.main}},clearButton:{marginTop:"12px",height:"45px",width:"120px",backgroundColor:t.palette.error[t.palette.type],"&:hover":{backgroundColor:t.palette.error.main}},shellBox:{marginTop:"20px",padding:"20px",width:"100%",height:"70%",overflow:"auto",backgroundColor:"#000000"},hostname:{width:"100%",color:"#fce700",whiteSpace:"pre-line",wordWrap:"break-word",wordBreak:"break-all"},shellMsg:{width:"100%",color:"#fff",marginBottom:"20px",whiteSpace:"pre-line",wordWrap:"break-word",wordBreak:"break-all"}})),he={hostList:"\u8BF7\u9009\u62E9\u4E3B\u673A",groupList:"\u8BF7\u9009\u62E9\u5206\u7EC4",tagList:"\u8BF7\u9009\u62E9\u6807\u7B7E",default:"\u8BF7\u5148\u9009\u62E9\u7C7B\u578B"};function v(){return[{host_id:0,hostname:"",msg:"",status:!1}]}function ge(t,a){switch(a.type){case"add":return[...t,a.payload];case"reset":return v();default:throw new Error}}const fe=({hostList:t,groupList:a,tagList:o})=>{const{enqueueSnackbar:x}=K(),s=me(),[l,W]=u.exports.useState(""),[c,j]=u.exports.useState(""),[p,R]=u.exports.useState(""),[$,M]=u.exports.useState(""),[m,C]=u.exports.useReducer(ge,v(),v),b=u.exports.useRef(null);u.exports.useEffect(()=>{const e=b.current;e.scrollTop=e.scrollHeight},[m]),u.exports.useEffect(()=>{const e=new WebSocket(`${V}${Z.index}`);return M(e),e.onopen=n=>{console.log("WebSocket\u670D\u52A1\u5668\u8FDE\u63A5\u6210\u529F\u6267\u884C\u547D\u4EE4")},e.onmessage=n=>{const{data:A}=JSON.parse(n.data);C({type:"add",payload:A})},e.onerror=n=>{console.warn(n),x(` WebSocket\u670D\u52A1\u5668\u8FDE\u63A5\u5931\u8D25: ${n.type}`,{autoHideDuration:2e3,variant:"error"})},e.onclose=function(n){console.log("Connection closed.",n),x(` WebSocket\u8FDE\u63A5\u5DF2\u5173\u95ED \u6267\u884C\u547D\u4EE4: ${n.type}`,{autoHideDuration:2e3,variant:"error"})},()=>{e.close()}},[]);const O=()=>{$.send(JSON.stringify({type:"WS_CMD",data:{type:l,id:c,cmd:p}}))},h=e=>l==="host"?e?t:"hostList":l==="group"?e?a:"groupList":l==="tag"?e?o:"tagList":e?[]:"default",q=e=>{j(e.target.value)};return i("div",{className:s.root,children:[i("div",{className:s.ControlBox,children:[i(T,{className:s.Control,children:[r(L,{children:"\u8BF7\u9009\u62E9\u7C7B\u578B"}),i(_,{id:"type-select",value:l,onChange:e=>W(e.target.value),children:[r(d,{value:"host",children:"\u4E3B\u673A"}),r(d,{value:"group",children:"\u7EC4"}),r(d,{value:"tag",children:"\u6807\u7B7E"})]})]}),i(T,{className:s.Control,children:[r(L,{children:he[h(!1)]}),r(_,{disabled:!l,labelId:"typeItem-select-label",id:"typeItem-select-label",value:c,onChange:q,children:h(!0).length>0?h(!0).map(e=>r(d,{value:e.id,children:e.name},e.name)):null})]}),r(ee,{style:{marginTop:"12px"},className:s.Control,size:"small",id:"cmd-disabled",label:"\u8BF7\u8F93\u5165\u6267\u884C\u7684\u547D\u4EE4",variant:"outlined",value:p,onChange:e=>R(e.target.value)}),r(F,{disabled:!(!!l&&!!c&&!!p),className:s.sendButton,startIcon:r(I,{}),onClick:O,children:"\u4E0B\u53D1\u547D\u4EE4"}),r(F,{className:s.clearButton,startIcon:r(N,{}),onClick:()=>{C({type:"reset"})},children:"\u6E05\u5C4F"})]}),r("div",{ref:b,className:s.shellBox,children:m.length>0?m.map(e=>i(Q,{children:[r("div",{className:s.hostname,children:e.hostname},new Date().getTime()+1),r("div",{className:s.shellMsg,children:e.msg},new Date().getTime()-1)]})):null})]})};var Be=X(ce,pe)(fe);export{Be as default};
