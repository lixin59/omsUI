var M=Object.defineProperty,G=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var j=(t,e,s)=>e in t?M(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,g=(t,e)=>{for(var s in e||(e={}))Q.call(e,s)&&j(t,s,e[s]);if(T)for(var s of T(e))U.call(e,s)&&j(t,s,e[s]);return t},C=(t,e)=>G(t,J(e));import{d as m,F as V,j as a,k as y,m as x,a5 as S,e as l,a4 as X}from"./vendor.3adfed64.js";import{T as Y,F as Z}from"./IconButton.cc13632c.js";import{s as k}from"./style.97b72400.js";import{o as ee,p as ae,c as te,q as ue}from"./httpRequestApi.785f0199.js";import{T as f}from"./TextField.84619a02.js";import{P as se,b as $}from"./MenuItem.fff0d7f8.js";import{T as ne,a as ie,b as re,c as w,d as N,e as le,f as oe}from"./TableRow.db7565dc.js";import{a as B}from"./action.c965c132.js";import"./DialogActions.9747b884.js";import"./Typography.3f3c5a2b.js";import"./KeyboardArrowRight.75cb1df8.js";import"./index.374d7e98.js";const ce=({Info:t,setInfo:e,fileName:s,setFileName:o})=>{const c=x(k)();return m(V,{children:[a(f,{autoFocus:!0,margin:"dense",id:"tag-name",label:"\u5BC6\u94A5\u540D\u79F0",fullWidth:!0,value:t.name,onChange:i=>e(C(g({},t),{name:i.target.value}))}),a(f,{autoFocus:!0,margin:"dense",id:"tag-name",label:"\u5BC6\u94A5\u7684\u5BC6\u7801",fullWidth:!0,value:t.passphrase,onChange:i=>e(C(g({},t),{passphrase:i.target.value}))}),m("div",{className:c.keyFile,children:[a(f,{size:"small",disabled:!0,id:"select-file",variant:"outlined",value:s}),a("input",{className:c.input,id:"contained-button-file",multiple:!0,type:"file",onChange:i=>{var p,d,F;!i.target.files[0].name||(e(C(g({},t),{key_file:(p=i.target)==null?void 0:p.files[0]})),o((F=(d=i.target)==null?void 0:d.files[0])==null?void 0:F.name))}}),a("label",{htmlFor:"contained-button-file",children:a(y,{variant:"contained",color:"primary",component:"span",children:"\u9009\u62E9\u79D8\u94A5\u6587\u4EF6"})})]})]})},de=[{id:"name",label:"\u5BC6\u94A5\u540D\u79F0",minWidth:170},{id:"operation",label:"\u64CD\u4F5C",minWidth:170}];function me({deletePrivateKey:t,privateKeyList:e,editPrivateKey:s}){const o=x(k)(),{enqueueSnackbar:c}=S(),[i,p]=l.exports.useState(0),[d,F]=l.exports.useState(10),[A,b]=l.exports.useState(!1),[P,n]=l.exports.useState(!1),[h,v]=l.exports.useState("\u672A\u9009\u62E9\u4EFB\u4F55\u6587\u4EF6"),[r,E]=l.exports.useState({id:0,name:"",passphrase:"",key_file:""}),H=ce({Info:r,setInfo:E,fileName:h,setFileName:v}),R="\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u4E2A\u5BC6\u94A5\u6587\u4EF6\u5417\uFF1F",W="\u5982\u679C\u4E0D\u60F3\u5220\u9664\u53EF\u4EE5\u70B9\u51FB\u53D6\u6D88",I=u=>{E(u),b(!0)},q=()=>{b(!1)},z=l.exports.useCallback(async()=>{const u=await ee(r);if(v("\u672A\u9009\u62E9\u4EFB\u4F55\u6587\u4EF6"),u.code!=="200"){c(`\u5BC6\u94A5: ${r.name}\u4FEE\u6539\u5931\u8D25${u.msg}`,{autoHideDuration:3e3,variant:"error"});return}s(u.data),c(`\u5BC6\u94A5: ${r.name} \u4FEE\u6539\u6210\u529F${u.msg}`,{autoHideDuration:3e3,variant:"success"})},[r]),O=l.exports.useCallback(async()=>{const u=await ae(r.id);if(u.code!=="200"){c(`\u5BC6\u94A5: ${r.name}\u5220\u9664\u5931\u8D25${u.msg}`,{autoHideDuration:3e3,variant:"error"});return}t(r.id),c(`\u5BC6\u94A5: ${r.name} \u5DF2\u88AB\u5220\u9664`,{autoHideDuration:3e3,variant:"success"})},[r]),_=(u,D)=>{p(D)},L=u=>{F(+u.target.value),p(0)};return m(se,{className:o.rootTable,children:[a(ne,{className:o.container,children:m(ie,{stickyHeader:!0,"aria-label":"sticky table",children:[a(re,{children:a(w,{children:de.map(u=>a(N,{align:"center",style:{minWidth:u.minWidth},children:u.label},u.id))})}),a(le,{children:e&&e.slice(i*d,i*d+d).map(u=>m(w,{hover:!0,role:"checkbox",tabIndex:-1,children:[a(N,{align:"center",children:u.name},u.name),m(N,{align:"center",children:[a(y,{className:o.editBtn,onClick:()=>{E(u),n(!0)},children:"\u7F16\u8F91"}),a(y,{className:o.deleteButton,onClick:()=>I(u),children:"\u5220\u9664"})]})]},u.name))})]})}),a(oe,{rowsPerPageOptions:[10,25,100],component:"div",labelRowsPerPage:a("div",{children:"\u6BCF\u9875\u884C\u6570:"}),labelDisplayedRows:({from:u,to:D,count:K})=>`${u}-${D} \u603B\u6570 ${K!==-1?K:0}`,count:e.length,rowsPerPage:d,page:i,onPageChange:_,onRowsPerPageChange:L}),a(Y,{open:A,title:R,text:W,toClose:q,todo:O}),a(Z,{open:P,content:H,toClose:()=>n(!1),title:"\u7F16\u8F91\u5BC6\u94A5\u4FE1\u606F",todo:z})]})}const pe=(t,e)=>C(g({},e),{privateKeyList:t.privateKeyList}),Fe={toInit:B.initPrivateKeyInfo,deletePrivateKey:B.deletePrivateKeyInfo,addPrivateKey:B.addPrivateKeyInfo,editPrivateKey:B.editPrivateKeyInfo},he=t=>{const e=x(k)(),{enqueueSnackbar:s}=S(),[o,c]=l.exports.useState(""),[i,p]=l.exports.useState(""),[d,F]=l.exports.useState("\u672A\u9009\u62E9\u6587\u4EF6"),[A,b]=l.exports.useState("");l.exports.useEffect(()=>{(async()=>{const n=await te();n.code==="200"&&t.toInit(n.data)})()},[]);const P=async()=>{if(t.privateKeyList.some(h=>h.name===i)){s("\u5BC6\u94A5\u5DF2\u5B58\u5728\uFF01",{autoHideDuration:3e3,variant:"warning"});return}const n=await ue({name:o,passphrase:i,key_file:A});if(n.code!=="200"){s(`\u5BC6\u94A5\u6DFB\u52A0\u5931\u8D25${n.msg}`,{autoHideDuration:3e3,variant:"error"});return}t.addPrivateKey(n.data),s(`\u5BC6\u94A5: ${n.data.name}\u6DFB\u52A0\u6210\u529F\uFF01`,{autoHideDuration:3e3,variant:"success"})};return m("div",{className:e.itemPage,children:[m("div",{className:e.ControlBox,children:[a($,{className:e.Control,children:a(f,{size:"small",id:"private-key-name",label:"\u5BC6\u94A5\u540D\u79F0",variant:"outlined",value:o,onChange:n=>c(n.target.value)})}),a($,{className:e.Control,children:a(f,{size:"small",id:"private-key-name",label:"\u5BC6\u94A5\u7684\u5BC6\u7801(\u975E\u5FC5\u586B)",variant:"outlined",placeholder:"\u5BC6\u94A5\u7684\u5BC6\u7801\u53EF\u4EE5\u4E3A\u7A7A",value:i,onChange:n=>p(n.target.value)})}),m("div",{className:e.keyFile,children:[a(f,{size:"small",disabled:!0,id:"select-file",variant:"outlined",value:d}),a("input",{className:e.input,id:"contained-key-file",multiple:!0,type:"file",onChange:n=>{var h,v,r;!n.target.files[0].name||(b((h=n.target)==null?void 0:h.files[0]),F((r=(v=n.target)==null?void 0:v.files[0])==null?void 0:r.name))}}),a("label",{htmlFor:"contained-key-file",children:a(y,{variant:"contained",color:"primary",component:"span",children:"\u9009\u62E9\u79D8\u94A5\u6587\u4EF6"})})]}),a(y,{className:e.addButton,onClick:P,children:"\u6DFB\u52A0\u5BC6\u94A5"})]}),a("div",{className:e.shellBox,children:a(me,g({},t))})]})};var Ne=X(pe,Fe)(he);export{Ne as default};
