var L=Object.defineProperty,Q=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var W=(e,n,i)=>n in e?L(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i,b=(e,n)=>{for(var i in n||(n={}))V.call(n,i)&&W(e,i,n[i]);if(R)for(var i of R(n))X.call(n,i)&&W(e,i,n[i]);return e},C=(e,n)=>Q(e,U(n));import{d as o,F as Y,j as t,m as _,a5 as H,e as d,k as j,a4 as Z}from"./vendor.3adfed64.js";import{T as ee,F as te}from"./IconButton.cc13632c.js";import{T as A}from"./TextField.84619a02.js";import{b as F,I as B,S as y,M as v,P as ae}from"./MenuItem.fff0d7f8.js";import{y as ne,z as le,A as ie,B as ue}from"./httpRequestApi.785f0199.js";import{T as oe,a as se,b as re,c as I,d as h,e as de,f as ce}from"./TableRow.db7565dc.js";import{a as P}from"./action.c965c132.js";import"./DialogActions.9747b884.js";import"./Typography.3f3c5a2b.js";import"./KeyboardArrowRight.75cb1df8.js";import"./index.374d7e98.js";const $=e=>({root:{flexGrow:1,display:"flex",height:"100%",width:"100%",indicator:{"& > span":{maxWidth:40,width:"100%",backgroundColor:"#4bce21"}}},itemPage:{width:"100%",height:"100%"},ControlBox:{marginBottom:"20px",width:"100%",display:"flex",alignContent:"space-evenly",alignItems:"center",justifyContent:"space-between"},Control:{width:"15%"},shellBox:{width:"100%",height:"90%"},TabPanel:{height:"100%",width:"100%"},tabs:{width:"240px",borderRight:`1px solid ${e.palette.divider}`},rootTable:{width:"100%",height:"100%"},container:{height:"92%"},editBtn:{marginRight:"14px",backgroundColor:e.palette.warning[e.palette.type],"&:hover":{backgroundColor:e.palette.warning.main}},deleteButton:{backgroundColor:e.palette.error[e.palette.type],"&:hover":{backgroundColor:e.palette.error.main}},addButton:{backgroundColor:e.palette.success[e.palette.type],"&:hover":{backgroundColor:e.palette.success.main}}}),he=({Info:e,hostList:n,setInfo:i})=>o(Y,{children:[t(A,{autoFocus:!0,margin:"dense",id:"source",label:"\u76EE\u6807\u5730\u5740",fullWidth:!0,value:e.source,onChange:u=>i(C(b({},e),{source:u.target.value}))}),t(A,{autoFocus:!0,margin:"dense",id:"destination",label:"\u76D1\u542C\u5730\u5740",fullWidth:!0,value:e.destination,onChange:u=>i(C(b({},e),{destination:u.target.value}))}),o(F,{style:{width:"100%"},children:[t(B,{id:"mode-select-label",children:"\u9009\u62E9\u96A7\u9053\u6A21\u5F0F "}),o(y,{labelId:"mode-select-label",id:"mode-select",value:e.mode,onChange:u=>i(C(b({},e),{mode:u.target.value})),children:[t(v,{value:"local",children:"local"}),t(v,{value:"remote",children:"remote"})]})]}),o(F,{style:{width:"100%"},children:[t(B,{id:"host_id-select-label",children:"\u9009\u62E9\u4E3B\u673A "}),t(y,{labelId:"host_id-select-label",id:"host_id-select",value:e.host_id,onChange:u=>i(C(b({},e),{host_id:u.target.value})),children:n&&n.map(u=>t(v,{value:u.id,children:u.name},u.id))})]})]}),ge=[{id:"mode",label:"\u96A7\u9053\u6A21\u5F0F",minWidth:50},{id:"source",label:"\u76EE\u6807\u5730\u5740",minWidth:50},{id:"destination",label:"\u76D1\u542C\u5730\u5740",minWidth:50},{id:"status",label:"\u72B6\u6001",minWidth:50},{id:"error_msg",label:"\u4FE1\u606F",minWidth:50},{id:"density",label:"\u64CD\u4F5C",minWidth:100}];function me({deleteTunnel:e,tunnelList:n,hostList:i,editTunnel:u}){const g=_($)(),{enqueueSnackbar:m}=H(),[s,p]=d.exports.useState(0),[c,w]=d.exports.useState(10),[x,E]=d.exports.useState(!1),[f,D]=d.exports.useState(!1),[r,T]=d.exports.useState({id:0,mode:"local",source:"",destination:"",error_msg:"",status:0,host_id:0}),k=he({Info:r,setInfo:T,hostList:i}),l=d.exports.useCallback(async()=>{const a=await ne(r);if(a.code!=="200"){m(`\u4FEE\u6539\u5931\u8D25${a.msg}`,{autoHideDuration:3e3,variant:"error"});return}u(a.data),m(`\u4FEE\u6539\u6210\u529F${a.msg}`,{autoHideDuration:3e3,variant:"success"})},[r]),M="\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u4E2A\u96A7\u9053\u5417\uFF1F",q="\u5982\u679C\u4E0D\u60F3\u5220\u9664\u53EF\u4EE5\u70B9\u51FB\u53D6\u6D88",z=a=>{T(a),E(!0)},O=()=>{E(!1)},G=d.exports.useCallback(async()=>{const a=await le(r.id);if(a.code!=="200"){m(`\u96A7\u9053id: ${r.id}\u5220\u9664\u5931\u8D25${a.msg}`,{autoHideDuration:3e3,variant:"error"});return}e(r.id),m(`\u96A7\u9053id: ${r.id} \u5DF2\u88AB\u5220\u9664`,{autoHideDuration:3e3,variant:"success"})},[r]),J=(a,S)=>{p(S)},K=a=>{w(+a.target.value),p(0)};return o(ae,{className:g.rootTable,children:[t(oe,{className:g.container,children:o(se,{stickyHeader:!0,"aria-label":"sticky table",children:[t(re,{children:t(I,{children:ge.map(a=>t(h,{align:"center",style:{minWidth:a.minWidth},children:a.label},a.id))})}),t(de,{children:n&&n.slice(s*c,s*c+c).map(a=>o(I,{hover:!0,role:"checkbox",tabIndex:-1,children:[t(h,{align:"center",children:a.mode},a.mode),t(h,{align:"center",children:a.source},a.source),t(h,{align:"center",children:a.destination},a.destination),t(h,{align:"center",children:String(a.status)},String(new Date().getTime())),t(h,{align:"center",children:a.error_msg},a.error_msg),o(h,{align:"center",children:[t(j,{className:g.editBtn,onClick:()=>{T(a),D(!0)},children:"\u7F16\u8F91"}),t(j,{className:g.deleteButton,onClick:()=>z(a),children:"\u5220\u9664"})]})]},a.id))})]})}),t(ce,{rowsPerPageOptions:[10,25,100],component:"div",labelRowsPerPage:t("div",{children:"\u6BCF\u9875\u884C\u6570:"}),labelDisplayedRows:({from:a,to:S,count:N})=>`${a}-${S} \u603B\u6570 ${N!==-1?N:0}`,count:n.length,rowsPerPage:c,page:s,onPageChange:J,onRowsPerPageChange:K}),t(ee,{open:x,title:M,text:q,toClose:O,todo:G}),t(te,{open:f,content:k,toClose:()=>D(!1),title:"\u7F16\u8F91Tunnel\u4FE1\u606F",todo:l})]})}const pe=(e,n)=>C(b({},n),{tunnelList:e.tunnelList,hostList:e.hostList}),be={toInit:P.initTunnelInfo,deleteTunnel:P.deleteTunnelInfo,addTunnel:P.addTunnelInfo,editTunnel:P.editTunnelInfo},Ce=({hostList:e,tunnelList:n,addTunnel:i,editTunnel:u,deleteTunnel:g,toInit:m})=>{d.exports.useEffect(()=>{(async()=>{const l=await ie();l.code==="200"&&m(l.data)})()},[]);const s=_($)(),{enqueueSnackbar:p}=H(),[c,w]=d.exports.useState(""),[x,E]=d.exports.useState(""),[f,D]=d.exports.useState(""),[r,T]=d.exports.useState(""),k=async()=>{if(c===""){p("\u8BF7\u9009\u62E9\u4E00\u4E2A\u6A21\u5F0F\uFF01",{autoHideDuration:3e3,variant:"warning"});return}if(!r){p("\u76D1\u542C\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A\uFF01",{autoHideDuration:3e3,variant:"warning"});return}const l=await ue({mode:c,source:f,destination:r,host_id:x});if(l.code!=="200"){p(`\u6DFB\u52A0\u4EFB\u52A1\u5931\u8D25${l.msg}`,{autoHideDuration:3e3,variant:"error"});return}i(l.data)};return o("div",{className:s.itemPage,children:[o("div",{className:s.ControlBox,children:[o(F,{className:s.Control,children:[t(B,{id:"job-select-label",children:"\u9009\u62E9\u96A7\u9053\u6A21\u5F0F"}),o(y,{labelId:"job-select-label",id:"job-select",value:c,onChange:l=>w(l.target.value),children:[t(v,{value:"local",children:"local"}),t(v,{value:"remote",children:"remote"})]})]}),o(F,{className:s.Control,children:[t(B,{id:"hostid-select-label",children:"\u9009\u62E9\u4E3B\u673A"}),t(y,{labelId:"hostid-select-label",id:"hostid-select-tunnel",value:x,onChange:l=>E(l.target.value),children:e.map(l=>t(v,{value:l.id,children:l.name},l.id))})]}),t(F,{className:s.Control,children:t(A,{size:"small",id:"src-tunnel",label:"\u6E90\u5730\u5740",variant:"outlined",value:f,onChange:l=>D(l.target.value)})}),t(F,{className:s.Control,children:t(A,{size:"small",label:"\u76D1\u542C\u5730\u5740",id:"dest-tunnel",variant:"outlined",value:r,onChange:l=>T(l.target.value)})}),t(j,{className:s.addButton,onClick:k,children:"\u589E\u52A0\u96A7\u9053"})]}),t("div",{className:s.shellBox,children:t(me,{deleteTunnel:g,tunnelList:n,editTunnel:u,hostList:e})})]})};var ke=Z(pe,be)(Ce);export{ke as default};
