var M=Object.defineProperty,R=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var j=(a,t,n)=>t in a?M(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,I=(a,t)=>{for(var n in t||(t={}))H.call(t,n)&&j(a,n,t[n]);if(T)for(var n of T(t))J.call(t,n)&&j(a,n,t[n]);return a},A=(a,t)=>R(a,_(t));import{M as D,e as c,Q as X,al as G,_ as Q,E,V as v,aF as V,aG as K,i as W,m as $,d as m,j as r,a4 as Y,a5 as Z}from"./vendor.3adfed64.js";import{U as ee}from"./UploadButton.d7903e35.js";import{O,a as U,S as k}from"./OmsMenuItem.851b2a4d.js";import{B as f}from"./Box.bedefe80.js";import{T as g}from"./Typography.3f3c5a2b.js";import{b as te,u as ae}from"./url.3ef8f631.js";import{l as re}from"./lodash.50dedf73.js";import{b as q}from"./MenuItem.fff0d7f8.js";import{T as oe}from"./TextField.84619a02.js";import"./httpRequestApi.785f0199.js";var P=4,ne=function(t){var n=function(u){return t.palette.type==="light"?V(u,.62):K(u,.5)},o=n(t.palette.primary.main),s=n(t.palette.secondary.main);return{root:{position:"relative",overflow:"hidden",height:4,"@media print":{colorAdjust:"exact"}},colorPrimary:{backgroundColor:o},colorSecondary:{backgroundColor:s},determinate:{},indeterminate:{},buffer:{backgroundColor:"transparent"},query:{transform:"rotate(180deg)"},dashed:{position:"absolute",marginTop:0,height:"100%",width:"100%",animation:"$buffer 3s infinite linear"},dashedColorPrimary:{backgroundImage:"radial-gradient(".concat(o," 0%, ").concat(o," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0 -23px"},dashedColorSecondary:{backgroundImage:"radial-gradient(".concat(s," 0%, ").concat(s," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0 -23px"},bar:{width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},barColorPrimary:{backgroundColor:t.palette.primary.main},barColorSecondary:{backgroundColor:t.palette.secondary.main},bar1Indeterminate:{width:"auto",animation:"$indeterminate1 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite"},bar1Determinate:{transition:"transform .".concat(P,"s linear")},bar1Buffer:{zIndex:1,transition:"transform .".concat(P,"s linear")},bar2Indeterminate:{width:"auto",animation:"$indeterminate2 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite"},bar2Buffer:{transition:"transform .".concat(P,"s linear")},"@keyframes indeterminate1":{"0%":{left:"-35%",right:"100%"},"60%":{left:"100%",right:"-90%"},"100%":{left:"100%",right:"-90%"}},"@keyframes indeterminate2":{"0%":{left:"-200%",right:"100%"},"60%":{left:"107%",right:"-8%"},"100%":{left:"107%",right:"-8%"}},"@keyframes buffer":{"0%":{opacity:1,backgroundPosition:"0 -23px"},"50%":{opacity:0,backgroundPosition:"0 -23px"},"100%":{opacity:1,backgroundPosition:"-200px -23px"}}}},ie=c.exports.forwardRef(function(t,n){var o=t.classes,s=t.className,d=t.color,u=d===void 0?"primary":d,p=t.value,x=t.valueBuffer,y=t.variant,i=y===void 0?"indeterminate":y,S=X(t,["classes","className","color","value","valueBuffer","variant"]),B=G(),h={},b={bar1:{},bar2:{}};if((i==="determinate"||i==="buffer")&&p!==void 0){h["aria-valuenow"]=Math.round(p),h["aria-valuemin"]=0,h["aria-valuemax"]=100;var e=p-100;B.direction==="rtl"&&(e=-e),b.bar1.transform="translateX(".concat(e,"%)")}if(i==="buffer"&&x!==void 0){var l=(x||0)-100;B.direction==="rtl"&&(l=-l),b.bar2.transform="translateX(".concat(l,"%)")}return c.exports.createElement("div",Q({className:E(o.root,o["color".concat(v(u))],s,{determinate:o.determinate,indeterminate:o.indeterminate,buffer:o.buffer,query:o.query}[i]),role:"progressbar"},h,{ref:n},S),i==="buffer"?c.exports.createElement("div",{className:E(o.dashed,o["dashedColor".concat(v(u))])}):null,c.exports.createElement("div",{className:E(o.bar,o["barColor".concat(v(u))],(i==="indeterminate"||i==="query")&&o.bar1Indeterminate,{determinate:o.bar1Determinate,buffer:o.bar1Buffer}[i]),style:b.bar1}),i==="determinate"?null:c.exports.createElement("div",{className:E(o.bar,(i==="indeterminate"||i==="query")&&o.bar2Indeterminate,i==="buffer"?[o["color".concat(v(u))],o.bar2Buffer]:o["barColor".concat(v(u))]),style:b.bar2}))}),se=D(ne,{name:"MuiLinearProgress"})(ie);const le=D(a=>W({root:{height:10,borderRadius:5},colorPrimary:{backgroundColor:a.palette.grey[a.palette.type==="light"?200:700]},bar:{borderRadius:5,backgroundColor:"#1a90ff"}}))(se),de=$({root:{width:"100%",maxWidth:"1200px",marginTop:"20px",marginBottom:"20px",padding:"10px",border:"1px solid #000"}});function ue(a){const t=de();return m("div",{className:t.root,children:[r("div",{children:m(f,{display:"flex",justifyContent:"space-around",alignItems:"center",children:[r(f,{minWidth:35,children:r(g,{variant:"body2",color:"textSecondary",children:a.dest})}),r(f,{minWidth:35,children:r(g,{variant:"body2",color:"textSecondary",children:a.file})}),r(f,{minWidth:35,children:r(g,{variant:"body2",color:"textSecondary",children:a.total})}),r(f,{minWidth:35,children:r(g,{variant:"body2",color:"textSecondary",children:a.speed})}),r(f,{minWidth:35,children:r(g,{variant:"body2",color:"textSecondary",children:a.status})})]})}),m(f,{display:"flex",alignItems:"center",children:[r(f,{width:"100%",mr:1,children:r(le,I({variant:"determinate"},a))}),r(f,{minWidth:35,children:r(g,{variant:"body2",color:"textSecondary",children:`${Math.round(a.value)}%`})})]})]})}const ce=(a,t)=>A(I({},t),{hostList:a.hostList,groupList:a.groupList,tagList:a.tagList}),me={},fe=$(a=>W({root:{width:"100%",height:"100%"},ControlBox:{marginBottom:"20px",width:"100%",display:"flex",alignContent:"space-evenly",alignItems:"center",justifyContent:"space-between"},Control:{width:"25%"},shellBox:{width:"100%",height:"70%"}})),he={hostList:"\u8BF7\u9009\u62E9\u4E3B\u673A",groupList:"\u8BF7\u9009\u62E9\u5206\u7EC4",tagList:"\u8BF7\u9009\u62E9\u6807\u7B7E",default:"\u8BF7\u9009\u62E9\u5B50\u9009\u9879"};let F=[];const pe=({hostList:a,groupList:t,tagList:n})=>{const{enqueueSnackbar:o}=Z(),s=fe(),[d,u]=c.exports.useState(""),[p,x]=c.exports.useState(""),[y,i]=c.exports.useState(""),[S,B]=c.exports.useState([]);c.exports.useEffect(()=>{const e=new WebSocket(`${te}${ae.index}`);return e.onopen=l=>{console.log("WebSocket\u670D\u52A1\u5668\u8FDE\u63A5\u6210\u529F\u4E0A\u4F20\u6587\u4EF6"),e.send(JSON.stringify({type:"FILE_STATUS"}))},e.onmessage=l=>{const{data:N}=JSON.parse(l.data);F.forEach((L,z)=>{N.forEach(C=>{(L==null?void 0:L.id)===(C==null?void 0:C.id)&&(F[z]=C)})});const w=re.uniqBy([...F,...N],"id");F=w,B(w)},e.onerror=l=>{console.warn(l),o(` WebSocket\u670D\u52A1\u5668\u8FDE\u63A5\u5931\u8D25: ${l.type}`,{autoHideDuration:2e3,variant:"error"})},e.onclose=function(l){console.log("Connection closed.",l),o(` WebSocket\u8FDE\u63A5\u5DF2\u5173\u95ED \u4E0A\u4F20\u6587\u4EF6: ${l.type}`,{autoHideDuration:2e3,variant:"error"})},()=>{e.close()}},[]);const h=e=>d==="host"?e?a:"hostList":d==="group"?e?t:"groupList":d==="tag"?e?n:"tagList":e?[]:"default",b=e=>{x(e.target.value)};return m("div",{className:s.root,children:[m("div",{className:s.ControlBox,children:[m(q,{className:s.Control,children:[r(O,{children:"\u8BF7\u9009\u62E9\u7C7B\u578B"}),m(U,{id:"type-select",value:d,onChange:e=>u(e.target.value),children:[r(k,{value:"host",children:"\u4E3B\u673A"}),r(k,{value:"group",children:"\u7EC4"}),r(k,{value:"tag",children:"\u6807\u7B7E"})]})]}),m(q,{className:s.Control,children:[r(O,{children:he[h(!1)]}),r(U,{disabled:!d,labelId:"typeItem-select-label",id:"typeItem-select-label",value:p,onChange:b,children:h(!0).length>0?h(!0).map(e=>r(k,{value:e.id,children:e.name},e.name)):null})]})]}),m("div",{className:s.ControlBox,children:[r(oe,{className:s.Control,size:"small",id:"outlined-disabled",label:"\u8BF7\u8F93\u5165\u8FDC\u7A0B\u7AEF\u6587\u4EF6\u5B58\u50A8\u7684\u8DEF\u5F84",variant:"outlined",value:y,onChange:e=>i(e.target.value)}),r(ee,{filePath:y,typeId:p,type:d})]}),r("div",{className:s.shellBox,children:S&&S.map(e=>r(ue,{dest:e.dest,total:e.total,value:e.percent,file:e.file,speed:e.speed,status:e.status},e.id))})]})};var Le=Y(ce,me)(pe);export{Le as default};
